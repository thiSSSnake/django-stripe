# Проект "Django + Stripe API"

## Описание

Этот проект представляет собой Django-приложение, интегрированное со Stripe API, и является реализацией тестового задания. 
Приложение позволяет управлять товарами через админку Django и предоставляет API для получения Stripe Session ID 
для оплаты выбранного товара, а также для отображения информации о товаре с возможностью инициировать процесс оплаты.
Логика реализована с помощью базовых возможностей Django, без Django Rest Framework, что бы продемонстрировать возможности Django.

### Функциональность

- **Модель Item**: Содержит поля `name`, `description`, `price`.
- **API-методы**:
  - `GET /buy/{id}`: Возвращает Stripe Session ID для оплаты выбранного товара. При вызове этого метода с бэкенда с помощью библиотеки `stripe` выполняется запрос `stripe.checkout.Session.create(...)`, а полученный `session.id` возвращается в ответе.
  - `GET /item/{id}`: Возвращает HTML-страницу с информацией о выбранном товаре и кнопкой "Buy". При нажатии на кнопку выполняется запрос к `/buy/{id}`, получая `session_id`, и с помощью JS-библиотеки Stripe происходит редирект на форму оплаты `stripe.redirectToCheckout(sessionId=session_id)`.

## Запуск проекта

### Предварительные требования

- Установлен Docker.
- Установлен Docker Compose.

### Шаги для запуска

1. **Склонируйте репозиторий:**
   ```bash
   git clone <URL_репозитория>
   cd <имя_папки_проекта>
   ```

2. **Соберите и запустите контейнеры с помощью Docker Compose:**
   ```bash
   docker-compose up --build
   ```
   Это действие:
   - Соберет Docker-образ.
   - Запустит контейнеры.
   - Применит миграции.
   - Запустит сервер Django на порту 8000.

3. **Создайте суперпользователя (администратора):**
   После запуска контейнеров необходимо создать суперпользователя для доступа к админке сайта. Выполните команду:
   ```bash
   docker exec -it <имя_контейнера> python manage.py createsuperuser
   ```
   - Замените `<имя_контейнера>` на имя вашего контейнера (например, `<имя_проекта>_web_1`).
   - Введите имя пользователя, email и пароль по инструкциям в терминале.
   - Суперпользователь обязателен для управления товарами через админку.

4. **Доступ к админке:**
   - Откройте браузер и перейдите по адресу `http://localhost:8000/admin/`.
   - Войдите, используя учетные данные суперпользователя.

## Использование

- Посмотреть работу функционала можно через пользовательский интерфейс, либо через отправку http запросов (например через curl)
- Для получения Stripe Session ID используйте `GET /buy/{id}`, где `{id}` — идентификатор товара.
- Для просмотра информации о товаре и кнопки "Buy" используйте `GET /item/{id}`.

## Примечания

- Для остановки контейнеров используйте:
  ```bash
  docker-compose down
  ```
- Убедитесь, что все переменные окружающей среды настроены в .env файле для корректной работы всего сервиса.
- Посмотреть какие нужны ENV VAR, можно в файле .env.example